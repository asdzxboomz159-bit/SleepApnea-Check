<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SleepApnea Check - ตรวจสอบภาวะหยุดหายใจขณะหลับ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap');
        body { font-family: 'Kanit', sans-serif; background-color: #0f172a; color: #f8fafc; overflow-x: hidden; }
        .glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); }
        .gradient-text { background: linear-gradient(90deg, #38bdf8, #818cf8); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        /* ป้องกันหน้าจอเลื่อนเวลาเปิดกราฟ */
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
            overflow: hidden;
        }
    </style>
</head>
<body>

    <!-- Navigation -->
    <nav class="p-6 flex justify-between items-center max-w-7xl mx-auto">
        <div class="text-2xl font-bold gradient-text">SleepApnea Check</div>
        <div class="hidden md:flex space-x-8 text-sm uppercase tracking-widest">
            <a href="#home" class="hover:text-sky-400 transition">หน้าแรก</a>
            <a href="#analysis" class="hover:text-sky-400 transition">การวิเคราะห์</a>
            <a href="#about" class="hover:text-sky-400 transition">เกี่ยวกับเรา</a>
        </div>
        <button class="bg-sky-500 hover:bg-sky-600 px-6 py-2 rounded-full text-sm font-semibold transition shadow-lg shadow-sky-500/20">ดาวน์โหลดแอป</button>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="max-w-7xl mx-auto px-6 py-12 md:py-24 grid md:grid-cols-2 gap-12 items-center">
        <div>
            <h1 class="text-4xl md:text-6xl font-bold mb-6 leading-tight">
                ตรวจจับภาวะ <span class="text-sky-400">หยุดหายใจ</span> <br>ขณะหลับด้วยตัวคุณเอง
            </h1>
            <p class="text-slate-400 text-lg mb-8">
                ใช้เทคโนโลยี AI วิเคราะห์เสียงกรนผ่านสมาร์ทโฟน เพื่อประเมินความเสี่ยงโรคหัวใจและหลอดเลือดเบื้องต้น แม่นยำ เข้าถึงง่าย และเป็นส่วนตัว
            </p>
            <div class="flex space-x-4">
                <button class="bg-white text-slate-900 px-8 py-3 rounded-xl font-bold flex items-center transition hover:scale-105">
                    <i class="fab fa-apple mr-2 text-xl"></i> App Store
                </button>
                <button class="bg-slate-800 text-white px-8 py-3 rounded-xl font-bold flex items-center border border-slate-700 transition hover:scale-105">
                    <i class="fab fa-google-play mr-2 text-xl"></i> Play Store
                </button>
            </div>
        </div>
        <div class="relative">
            <div class="absolute -inset-4 bg-sky-500/20 blur-3xl rounded-full"></div>
            <div class="glass p-8 rounded-3xl relative overflow-hidden">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <p class="text-slate-400 text-sm">สถานะการนอนหลับคืนนี้</p>
                        <h3 class="text-2xl font-bold">ความเสี่ยง: <span class="text-yellow-400">ปานกลาง</span></h3>
                    </div>
                    <div class="bg-yellow-400/20 p-3 rounded-2xl text-yellow-400 text-xl font-bold">AHI: 18.5</div>
                </div>
                <div class="h-[200px]">
                    <canvas id="heroChart"></canvas>
                </div>
            </div>
        </div>
    </section>

    <!-- Analysis Demo Section -->
    <section id="analysis" class="max-w-7xl mx-auto px-6 py-20">
        <div class="text-center mb-16">
            <h2 class="text-3xl font-bold mb-4">ระบบวิเคราะห์สัญญาณเสียง (Signal Processing)</h2>
            <p class="text-slate-400">จำลองการทำงานของแอปพลิเคชันขณะตรวจจับเสียงกรนปกติและช่วงที่เกิด Apnea Event</p>
        </div>

        <div class="grid md:grid-cols-3 gap-8 mb-12">
            <div class="glass p-6 rounded-2xl border-l-4 border-sky-400">
                <i class="fas fa-microphone text-sky-400 text-3xl mb-4"></i>
                <h4 class="font-bold mb-2">Audio Capture</h4>
                <p class="text-sm text-slate-400">บันทึกเสียงคุณภาพสูงและตัดเสียงรบกวนรอบข้างออก (Noise Reduction)</p>
            </div>
            <div class="glass p-6 rounded-2xl border-l-4 border-purple-400">
                <i class="fas fa-wave-square text-purple-400 text-3xl mb-4"></i>
                <h4 class="font-bold mb-2">Pattern Recognition</h4>
                <p class="text-sm text-slate-400">แยกแยะคลื่นเสียงกรนปกติ ออกจากเสียงสำลักหรือช่วงที่เสียงหายไปผิดปกติ</p>
            </div>
            <div class="glass p-6 rounded-2xl border-l-4 border-green-400">
                <i class="fas fa-notes-medical text-green-400 text-3xl mb-4"></i>
                <h4 class="font-bold mb-2">AHI Calculation</h4>
                <p class="text-sm text-slate-400">คำนวณดัชนีการหยุดหายใจต่อชั่วโมงเพื่อสรุปความรุนแรงทางการแพทย์</p>
            </div>
        </div>

        <!-- Live Demo Container -->
        <div class="glass p-8 rounded-3xl">
            <div class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
                <h3 class="text-xl font-bold italic"><i class="fas fa-circle text-red-500 animate-pulse mr-2"></i> กราฟคลื่นเสียงแนวนอน (Live Stream)</h3>
                <div class="flex space-x-4">
                    <div class="flex items-center space-x-2">
                        <div class="w-3 h-3 bg-sky-500 rounded-full"></div>
                        <span class="text-xs text-slate-400">ปกติ (Normal)</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <div class="w-3 h-3 bg-red-500 rounded-full"></div>
                        <span class="text-xs text-slate-400">ภาวะหยุดหายใจ (Apnea)</span>
                    </div>
                </div>
            </div>
            <!-- ส่วนของกราฟที่ได้รับการปรับปรุง -->
            <div class="chart-container">
                <canvas id="liveAnalysisChart"></canvas>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="about" class="border-t border-slate-800 mt-20 p-12 text-center">
        <p class="text-slate-500 mb-4">โครงงานโดย กลุ่มที่ 2 ม.4/1 และ ม.4/3</p>
        <div class="flex justify-center space-x-6 text-slate-400">
            <span>ฐิติวัสส์</span>
            <span>หาญหนุ่ม</span>
            <span>ธีรศานต์</span>
        </div>
        <p class="mt-8 text-xs text-slate-600 italic">* ข้อมูลนี้เป็นการประเมินเบื้องต้นเท่านั้น โปรดปรึกษาแพทย์เพื่อรับการตรวจอย่างเป็นทางการ *</p>
    </footer>

    <script>
        // Hero Chart
        const ctxHero = document.getElementById('heroChart').getContext('2d');
        new Chart(ctxHero, {
            type: 'line',
            data: {
                labels: ['22:00', '23:00', '00:00', '01:00', '02:00', '03:00', '04:00', '05:00'],
                datasets: [{
                    label: 'Oxygen Saturation (%)',
                    data: [98, 97, 94, 88, 92, 85, 96, 98],
                    borderColor: '#38bdf8',
                    borderWidth: 3,
                    tension: 0.4,
                    pointRadius: 0,
                    fill: true,
                    backgroundColor: 'rgba(56, 189, 248, 0.1)'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { 
                    y: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#64748b' }, min: 80, max: 100 },
                    x: { grid: { display: false }, ticks: { color: '#64748b' } }
                }
            }
        });

        // Live Analysis Simulation (Horizontal Scrolling Effect)
        const ctxLive = document.getElementById('liveAnalysisChart').getContext('2d');
        const totalPoints = 60; // จำนวนจุดบนกราฟ
        let liveData = Array(totalPoints).fill(0);
        let labels = Array(totalPoints).fill('');

        const liveChart = new Chart(ctxLive, {
            type: 'line', // เปลี่ยนเป็น line เพื่อให้คลื่นดูต่อเนื่อง
            data: {
                labels: labels,
                datasets: [{
                    label: 'Sound Amplitude',
                    data: liveData,
                    borderColor: '#38bdf8',
                    borderWidth: 2,
                    pointRadius: 0,
                    tension: 0.3, // ทำให้คลื่นมีความโค้งมน
                    fill: true,
                    backgroundColor: 'rgba(56, 189, 248, 0.15)',
                    segment: {
                        borderColor: ctx => {
                            const val = ctx.p1.parsed.y;
                            // ถ้าค่าต่ำมากในช่วงที่ควรจะกรน (Apnea) จะแสดงเป็นสีแดง
                            const cycle = (Date.now() / 1000 % 10);
                            return (cycle > 5 && cycle < 8) ? '#ef4444' : '#38bdf8';
                        }
                    }
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: false, // ปิด animation เพื่อให้กราฟไหลลื่นแบบ Real-time
                plugins: { legend: { display: false } },
                scales: {
                    y: { 
                        display: true, 
                        min: 0, 
                        max: 100,
                        grid: { color: 'rgba(255,255,255,0.03)' },
                        ticks: { display: false }
                    },
                    x: { display: false }
                }
            }
        });

        // Simulation Loop
        setInterval(() => {
            liveData.shift();
            
            let nextVal;
            const cycle = (Date.now() / 1000 % 10); // สร้างรอบ 10 วินาที
            
            if (cycle > 5 && cycle < 8) {
                // ช่วง Apnea (เงียบผิดปกติ)
                nextVal = Math.random() * 8 + 2; 
            } else {
                // ช่วง Snoring ปกติ (มีคลื่นสูงต่ำ)
                nextVal = Math.random() * 50 + 20; 
                // จำลองเสียงกรนเป็นจังหวะ
                if (Math.sin(Date.now() / 200) > 0.5) nextVal += 30;
            }
            
            liveData.push(nextVal);
            
            // อัปเดตสีพื้นหลังตามสถานะ
            if (cycle > 5 && cycle < 8) {
                liveChart.data.datasets[0].backgroundColor = 'rgba(239, 68, 68, 0.15)';
            } else {
                liveChart.data.datasets[0].backgroundColor = 'rgba(56, 189, 248, 0.15)';
            }
            
            liveChart.update('none'); // อัปเดตแบบไม่ต้องมี animation transition เพื่อความลื่นไหล
        }, 50); // อัปเดตทุก 50ms (20 FPS)

    </script>
</body>
</html>
